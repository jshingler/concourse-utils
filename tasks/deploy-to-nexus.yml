platform: linux
image_resource:
  type: docker-image
  source:
    repository: making/alpine-java-bash-git
inputs:
  - name: repo
  - name: utils
  - name: m2
outputs:
  - name: output
run:
  path: sh
  args:
  - -c
  - |
    utils/scripts/add-repos-in-pom-xml.sh repo && \
    utils/scripts/add-distribution-management-in-pom-xml.sh repo && \
    utils/scripts/generate-settings-xml.sh ${NEXUS_USERNAME} ${NEXUS_PASSWORD} repo && \
    utils/scripts/mvn.sh "deploy -s settings.xml -Dmaven.test.skip=true" repo